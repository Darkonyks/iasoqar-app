<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}{% endblock %} | ISOQAR</title>

  {% block extra_head %}{% endblock %}

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@3.2.0/dist/css/adminlte.min.css">
  <!-- jQuery UI -->
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.min.css">
  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
  <!-- Critical layout fixes - must be before other CSS -->
  <style>
    /* Kritiƒçni fix za sidebar i layout */
    .main-sidebar {
      position: fixed !important;
      height: 100% !important; 
      z-index: 1100 !important;
    }
    .content-wrapper {
      margin-left: 250px !important;
      width: calc(100% - 250px) !important;
      overflow-x: hidden !important;
    }
    body.sidebar-collapse .content-wrapper {
      margin-left: 4.6rem !important;
      width: calc(100% - 4.6rem) !important;
    }
    .table-container {
      width: 100%;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    @media (max-width: 992px) {
      .content-wrapper {
        margin-left: 0 !important;
        width: 100% !important;
      }
    }
  </style>
  <!-- Select2 CSS -->
  <link rel="stylesheet" href="{% static 'vendor/select2/css/select2.min.css' %}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2-bootstrap4-theme@1.0.0/dist/select2-bootstrap4.min.css">
  <!-- Custom fixes -->
  <link rel="stylesheet" href="{% static 'css/custom.css' %}">
  {% block extrastyle %}
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
  {% endblock %}
</head>
<body class="{% block bodyclass %}{% endblock %}">
<div class="wrapper">
  {% include 'layouts/navbar.html' %}
  {% include 'layouts/sidebar.html' %}

  {% block content %}{% endblock %}
  
  <!-- Django Messages -->
  {% if messages %}
  <div id="django-messages" style="display: none;">
    {% for message in messages %}
    <div class="message" 
         data-tags="{{ message.tags }}" 
         data-message="{{ message }}"></div>
    {% endfor %}
  </div>
  {% endif %}

  {% include 'layouts/footer.html' %}
</div>
<!-- ./wrapper -->

<!-- SES Warning Suppression -->
<script>
// Intercept SES warnings about deprecated options
if (typeof globalThis.console !== 'undefined') {
  const originalWarn = console.warn;
  console.warn = function(...args) {
    // Filter out SES deprecation warnings
    if (args.length > 0 && typeof args[0] === 'string' && 
        (args[0].includes('dateTaming') || args[0].includes('mathTaming'))) {
      return; // Suppress these specific warnings
    }
    return originalWarn.apply(console, args);
  };
}
</script>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Session Handler -->
<script src="{% static 'js/auth/session-handler.js' %}"></script>
<!-- jQuery UI -->
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
<!-- DataTables -->
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<!-- Bootstrap 4 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- AdminLTE App -->
<script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2.0/dist/js/adminlte.min.js"></script>
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<!-- Messages handling with SweetAlert -->
<script>
  $(document).ready(function() {
    // Process Django messages with SweetAlert
    $('#django-messages .message').each(function() {
      var tags = $(this).data('tags');
      var message = $(this).data('message');
      var icon = 'info';
      
      // Map Django message tags to SweetAlert icons
      if (tags.includes('success')) {
        icon = 'success';
      } else if (tags.includes('error')) {
        icon = 'error';
      } else if (tags.includes('warning')) {
        icon = 'warning';
      } else if (tags.includes('info')) {
        icon = 'info';
      }
      
      // Show SweetAlert notification
      Swal.fire({
        icon: icon,
        title: tags.charAt(0).toUpperCase() + tags.slice(1),
        text: message,
        toast: true,
        position: 'top-end',
        showConfirmButton: false,
        timer: 5000,
        timerProgressBar: true
      });
    });
  });
</script>

{% block extrajs %}{% endblock %}
{% block extra_scripts %}{% endblock %}
